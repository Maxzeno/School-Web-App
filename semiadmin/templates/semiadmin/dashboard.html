{% extends 'semiadmin/base.html' %}
{% load static %}

{% block head %} 
<title>Dashboard | Command Day Secondary School</title> 
{% endblock %}


{% block body %}

<!-- start page title -->
<div class="row ">
  <div class="col-xl-12">
    <div class="card">
      <div class="card-body">
        <h4 class="page-title"> <i class="mdi mdi-view-dashboard title_icon"></i> Dashboard </h4>
      </div> <!-- end card body-->
    </div> <!-- end card -->
  </div><!-- end col-->
</div>
<!-- end page title -->

<div class="row ">
  <div class="col-xl-12">
    <div class="row">
      <div class="col-xl-8">
        <div class="row">
          <div class="col-lg-4">
            <div class="card widget-flat" id="student" style="on">
              <div class="card-body">
                <div class="float-right">
                  <i class="mdi mdi-account-multiple widget-icon"></i>
                </div>
                <h5 class="text-muted font-weight-normal mt-0" title="Current Number of Student"> <i class="mdi mdi-account-group title_icon"></i>  Active Students <a href="/portal/teacher/student" style="color: #6c757d; display: none;" id = "student_list"><i class = "mdi mdi-export"></i></a></h5>
                <h3 class="mt-3 mb-3">
                  {{ num_students }}                </h3>
                <p class="mb-0 text-muted">
                  <span class="text-nowrap">Total number of student</span>
                </p>
              </div> <!-- end card-body-->
            </div> <!-- end card-->
          </div> <!-- end col-->

          <div class="col-lg-4">
            <div class="card widget-flat" id="student" style="on">
              <div class="card-body">
                <div class="float-right">
                  <i class="mdi mdi-account-multiple widget-icon"></i>
                </div>
                <h5 class="text-muted font-weight-normal mt-0" title="Number of Students that left"> <i class="mdi mdi-account-group title_icon"></i>  Students that Left <a href="/portal/teacher/student" style="color: #6c757d; display: none;" id = "student_list"><i class = "mdi mdi-export"></i></a></h5>
                <h3 class="mt-3 mb-3">
                  {{ num_left_school }}                </h3>
                <p class="mb-0 text-muted">
                  <span class="text-nowrap">Total number of students that left</span>
                </p>
              </div> <!-- end card-body-->
            </div> <!-- end card-->
          </div> <!-- end col-->

          <div class="col-lg-4">
            <div class="card widget-flat" id="teacher" style="on">
              <div class="card-body">
                <div class="float-right">
                  <i class="mdi mdi-account-multiple widget-icon"></i>
                </div>
                <h5 class="text-muted font-weight-normal mt-0" title="Number of Teacher"> <i class="mdi mdi-account-group title_icon"></i>Teacher  <a href="/portal/teacher/teacher" style="color: #6c757d; display: none;" id = "teacher_list"><i class = "mdi mdi-export"></i></a></h5>
                <h3 class="mt-3 mb-3">
                  {{ num_teachers }}                </h3>
                <p class="mb-0 text-muted">
                  <span class="text-nowrap">Total number of teacher</span>
                </p>
              </div> <!-- end card-body-->
            </div> <!-- end card-->
          </div> <!-- end col-->
        </div> <!-- end row -->

        <div class="row">
          <div class="col-lg-6">
            <div class="card widget-flat" id = "parent">
              <div class="card-body">
                <div class="float-right">
                  <i class="mdi mdi-account-multiple widget-icon"></i>
                </div>
                <h5 class="text-muted font-weight-normal mt-0" title="Number of Parents"> <i class="mdi mdi-account-group title_icon"></i> Parents <a href="/portal/teacher/teacher" style="color: #6c757d; display: none;" id = "parent_list"><i class = "mdi mdi-export"></i></a></h5>
                <h3 class="mt-3 mb-3">
                  {{ num_parents }}                </h3>
                <p class="mb-0 text-muted">
                  <span class="text-nowrap">Total number of parent</span>
                </p>
              </div> <!-- end card-body-->
            </div> <!-- end card-->
          </div> <!-- end col-->

          <div class="col-lg-6">
            <div class="card widget-flat">
              <div class="card-body">
                <div class="float-right">
                  <i class="mdi mdi-account-multiple widget-icon"></i>
                </div>
                <h5 class="text-muted font-weight-normal mt-0" title="Number of Staff"> <i class="mdi mdi-account-group title_icon"></i> Staff</h5>
                <h3 class="mt-3 mb-3">
                  {{ num_staffs }}                </h3>
                <p class="mb-0 text-muted">
                  <span class="text-nowrap">Total number of staff</span>
                </p>
              </div> <!-- end card-body-->
            </div> <!-- end card-->
          </div> <!-- end col-->
        </div>
      </div> <!-- end col -->
      <div class="col-xl-4">
        <div class="card bg-primary">
          <div class="card-body">
            <h4 class="header-title text-white mb-2">Todays attendance</h4>
            <div class="text-center">
              <h3 class="font-weight-normal text-white mb-2">{{ num_attendance }}</h3>
              <p class="text-light text-uppercase font-13 font-weight-bold">{{ num_attendance }} Students are attending today</p>
              <a href="/portal/teacher/attendance" class="btn btn-outline-light btn-sm mb-1">Go to attendance                <i class="mdi mdi-arrow-right ml-1"></i>
              </a>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-body">
            <h4 class="header-title">Recent events<a href="/portal/teacher/event_calendar" style="color: #6c757d;"><i class = "mdi mdi-export"></i></a></h4>
            <div class="slimscroll" style="max-height: 86px;">
              <div class="timeline-alt pb-0">
                <table class="table table-striped table-centered table-bordered mb-0 table-responsive">
<!--                 <thead>
                    <tr>
                        <th width = "60%">Title</th>
                        <th width = "40%">Date</th>
                    </tr>
                </thead> -->
                <tbody>
                  {% for event_calendar in event_calendars %}
                        <tr>
                          <td>{{ event_calendar.title }}</td>
                          <td>{{ event_calendar.starting_date }}</td>
                        </tr>
                      {% endfor %}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
      </div>
      </div>
    </div>
  </div><!-- end col-->
</div>


 
<div class="row">
  <div class="col-xl-12">
    <div class="row">
      <div class="col-xl-8">
        <div class="card">
          <div class="card-body">
            <h4 class="header-title mb-3">Accounts of {{ month }} <a href="/portal/teacher/invoice" style="color: #6c757d"><i class = "mdi mdi-export"></i></a></h4>
          <div class="card-body">
            <table id="basic-datatable" class="table table-striped dt-responsive nowrap" width="100%">
    <thead>
        <tr>
            <th>Student</th>
            <th>Class</th>
            <th>Invoice title</th>
            <th>Total amount</th>
            <th>Paid amount</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
          {% for invoice in invoices %}
            <tr>
              {% if invoice.student %}
              <td>{{ invoice.student.name }}</td>
              {% else %}
              <td></td>
              {% endif  %}

              <td>{{ invoice.the_class.the_class.the_class }}</td>
              <td>{{ invoice.invoice_title }}</td>
              <td>{{ invoice.total_amount }}</td>
              <td>{{ invoice.paid_amount }}</td>
              <td>{{ invoice.status }}</td>
            </tr>
          {% endfor %}
    </tbody>
</table>
          </div>
        </div>
      </div>
    </div>
      <div class="col-xl-4">
        <div class="card">
          <div class="card-body">
            <h4 class="header-title mb-3"> Expense of {{ month }} <a href="/portal/teacher/expense" style="color: #6c757d"><i class = "mdi mdi-export"></i></a></h4>
          <div class="card-body">
            <div class="table-responsive-sm">
    <table class="table table-striped table-centered table-bordered mb-0 table-responsive">
        <thead>
            <tr>
                <th width = "60%">Expense</th>
                <th width = "40%">Amount</th>
            </tr>
        </thead>
        <tbody>
          {% for expense in expenses %}
            <tr>
              <td>{{ expense.expense_category.name }}</td>
              <td>{{ expense.amount }}</td>
            </tr>
          {% endfor %}
          </tbody>
    </table>
</div>
<style>
.table-responsive {
    display: inline-table;
}
</style>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
$(document).ready(function() {
  initDataTable("expense-datatable");
});

$(".widget-flat").mouseenter(function() {
  var id = $(this).attr('id');
  $('#'+id+'_list').show();
}).mouseleave(function() {
  var id = $(this).attr('id');
  $('#'+id+'_list').hide();
});
</script>
                

{% endblock %}





